<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Resultados y Tabla de Posiciones</title>
  <link rel="icon" type="image/webp" href="images/logo.webp">
  <link rel="stylesheet" href="results_style.css">
</head>
<body>
  <div class="standings-frame">
  <section class="last-results">
    <h2>Última Fecha (26.10.2025)</h2>
      <table>
          <tr><th>Fecha 6</th><th>Score</th></tr>
          <tr><td>Tricolor vs Gonzalo Vial (Tercera Serie)</td><td class="draw">1 - 1</td></tr>
          <tr><td>Tricolor vs Gonzalo Vial (Segunda Serie)</td><td class="won">1 - 0</td></tr>
          <tr><td>Tricolor vs Gonzalo Vial (Infantil)</td><td class="won">2 - 1</td></tr>
          <tr><td>Tricolor vs Gonzalo Vial (Senior)</td><td class="lost">0 - 1</td></tr>
          <tr><td>Tricolor vs Gonzalo Vial (Primera Serie)</td><td class="won">4 - 1</td></tr>
      </table>
  </section>

  <section class="video">
    <h2>Tiro libre para el 3-0 parcial de la Primera serie</h2>
    <div class="video-container" id="video-container">
      <div class="video-placeholder">
        <div class="play-button">▶</div>
        <span>Click para reproducir</span>
      </div>
    </div>
  </div>

  <div id="standings-container"></div>

  <script>
    document.querySelector('.video-placeholder').addEventListener('click', function() {
      const videoContainer = document.getElementById('video-container');
      const video = document.createElement('video');
      video.controls = true;
      video.width = 600;
      const source = document.createElement('source');
      source.src = 'videos/tricolor_vial_3_0.mp4';
      source.type = 'video/mp4';
      video.appendChild(source);
      videoContainer.innerHTML = '';
      videoContainer.appendChild(video);
      video.play();
    });
  </script>
  <script>
    // Load standings from external file and ensure popup overlay + handlers
    (function() {
      const container = document.getElementById('standings-container');
      fetch('standings_B.html')
        .then(response => {
          if (!response.ok) throw new Error('Standings not found');
          return response.text();
        })
        .then(html => {
          // wrap the partial in a results-only frame so index won't show it
          container.innerHTML = '<div class="standings-frame">' + html + '</div>';

          // If overlay does not exist (partial didn't include it), create it
          if (!document.getElementById('table-overlay')) {
            const overlay = document.createElement('div');
            overlay.id = 'table-overlay';
            overlay.style.display = 'none';
            overlay.setAttribute('onclick', "this.style.display='none'");
            const popup = document.createElement('div');
            popup.id = 'table-popup';
            overlay.appendChild(popup);
            document.body.appendChild(overlay);
          }

          // Attach click handlers to any tables that appear inside the loaded standings
          document.querySelectorAll('.table-box table').forEach(table => {
            table.addEventListener('click', () => {
              const overlay = document.getElementById('table-overlay');
              const popup = document.getElementById('table-popup');
              popup.innerHTML = table.outerHTML; // clone the clicked table
              overlay.style.display = 'flex';
            });
          });
        })
        .catch(err => {
          // Fallback: try loading the default standings file
          console.error('Error loading standings_B.html:', err);
          if (container.innerHTML.trim() === '') {
            fetch('standings.html')
              .then(r => r.text())
              .then(html => {
                container.innerHTML = html;
                // attach handlers if needed (same as above)
                if (!document.getElementById('table-overlay')) {
                  const overlay = document.createElement('div');
                  overlay.id = 'table-overlay';
                  overlay.style.display = 'none';
                  overlay.setAttribute('onclick', "this.style.display='none'");
                  const popup = document.createElement('div');
                  popup.id = 'table-popup';
                  overlay.appendChild(popup);
                  document.body.appendChild(overlay);
                }
                document.querySelectorAll('.table-box table').forEach(table => {
                  table.addEventListener('click', () => {
                    const overlay = document.getElementById('table-overlay');
                    const popup = document.getElementById('table-popup');
                    popup.innerHTML = table.outerHTML;
                    overlay.style.display = 'flex';
                  });
                });
              })
              .catch(e => console.error('Also failed to load fallback standings:', e));
          }
        });
    })();
  </script>
  <div class="next-rivals">
    Próximo y Último Rival: <span class="team">Caracol (Fecha preliminar: 09.11.2025)</span>
  </div>
</body>
</html>
